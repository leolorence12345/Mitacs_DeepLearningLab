import bpy
from mathutils import Vector,Matrix
import math
import os


#Code for testing the camera for different locations and orientations
#------------------------------------------------------------------------
#Create a new camera object
#bpy.ops.object.camera_add()

## Get the reference to the newly created camera
#camera = bpy.context.object

## Set the camera location and rotation
#camera.location = (-0.6, 0, 0.65)  # Example location: x=0, y=0, z=10
#camera.rotation_euler = (0, -math.pi/2,0)  # Example rotation: 0 degrees on all axes

## Set camera parametersS
#camera.data.type = 'PERSP'  # Set camera type to perspective
#camera.data.lens = 10 # Set camera lens value (adjust as needed)
#camera.data.clip_start = 0.1  # Set near clipping distance
#camera.data.clip_end = 100.0  # Set far clipping distance00

#bpy.ops.object.camera_add()
#camera2 = bpy.context.object

## Set the second camera location and rotations
#camera2.location = (0, -0.5, 0.45)
#camera2.rotation_euler = ( math.pi/2, 0,  0)

## Set camera parameters for the second camera
#camera2.data.type = 'PERSP'
#camera2.data.lens = 8.50
#camera2.data.clip_start = 0.1
#camera2.data.clip_end = 100.000

## Set the first camera as the active camera
#bpy.context.scene.camera = camera

#-------------------------------------------------------------------------------
camera_configurations = [
#    {
#        'location': (-0.6, 0, 0.65),
#        'rotation_euler': (0, -math.pi/2,0),
#        'lens': 10,
#        'filename': 'FRONT_view'
#    },
    {
        'location': (0, -0.5, 0.45),
        'rotation_euler': (math.pi/2, 0,  0),
        'lens': 8.50,
        'filename': 'SIDE_view'
    }
]

#We use polylines to draw the backbone,tendons and bezier circles to draw the disks, which take in shape of the position and
#rotation arguments being passed into the function.
#--------------------------------------------------------------------------------
def draw_polyline(points,rotation):
    
    # Define the bevel depth required for the backbone
    bevel_depth = 0.006

    # Get the active object and scene
    scene = bpy.context.scene

    # Delete polyline object if it already exists(so as to automate the process and set rendering in the 
    #subsequent tasks for different position arguments
    
    for obj in bpy.data.objects:
        if obj.type == 'CURVE' and obj.name.startswith('myPolyline'):
            bpy.data.objects.remove(obj, do_unlink=True)

  # Create polyline object and set its data to a new Polyline curve
    curve_data = bpy.data.curves.new('myPolyline', type='CURVE')
    curve_data.dimensions = '3D'
    spline = curve_data.splines.new('POLY')

    # Set the control points of the Polyline curve
    spline.points.add(len(points) - 1)
    for i, point in enumerate(points):
        x, y, z = point
        spline.points[i].co = (x, y, z, 1)

    # Set the bevel depth of the curve
    curve_data.bevel_depth = bevel_depth

    # Set the resolution of the curve
    curve_data.resolution_u = 16
    spline.use_endpoint_u = True

    # Create a new polyline object and link it to the scene
    polyline_obj = bpy.data.objects.new('myPolyline', curve_data)
    scene.collection.objects.link(polyline_obj)
    polyline_obj.data.use_fill_caps = True

    # Set polyline object as active
    bpy.context.view_layer.objects.active = polyline_obj
    
    #Create the copies for the backbone required for the tendons.
#   -------------------------------------------------------------------------------- 

    distance= 0.025 #distance between the backbone and the tendon
    for i in range(4): 
        curve_copy = polyline_obj.copy() #create copy of the back bone 
        curve_copy.data = polyline_obj.data.copy()
        scene.collection.objects.link(curve_copy)
        bevel_depth = 0.0013 #change its bevel depth to the depth required for the tendons.
        
       # Set the location of the curve copy
        if i == 0:
            curve_copy.location = (distance, 0, 0) #x direction
        elif i == 1:
            curve_copy.location = (-distance, 0, 0) #-x direction
        elif i == 2:
            curve_copy.location = (0, distance, 0) #y direction
        else:
            curve_copy.location = (0, -distance, 0) #-y direction
            
        
        curve_copy.data.bevel_depth = bevel_depth
        mat = bpy.data.materials.new("RGBA")
#        mat.roughness = 0 #0 for perfectly smooth and 1 for rough
        mat.diffuse_color = (255/255.0, 221/255.0, 0,1)
        curve_copy.active_material = mat

        
#    Creating the disks on the backbone
#    -------------------------------------------------------------------------------------

    
    num_circles = 10  # Number of circles to be placed along the curve
    points_on_curve = []  # List to store the points on the curve where circles will be located
    step = len(points) // num_circles  # Determine the step size between the points on the curve
    index = len(points) - 2  # Starting index for iterating through the points on the curve

    #For Automation Loop through existing objects and remove any mesh objects with names starting with 'MyCurve'
    for obj in bpy.data.objects:
        if obj.type == 'MESH' and obj.name.startswith('MyCurve'):
            bpy.data.objects.remove(obj, do_unlink=True)

    bpy.ops.wm.console_toggle()  # Toggle the console to display output messages 
    print(index)  # Print the starting index value for debugging purposes

    # Iterate through the points on the curve in reverse order
    while index >= 0:
        points_on_curve.append(points[index])  # Append the current point to the list
        index -= step  # Update the index by subtracting the step value
        print(index)  # Print the updated index value for debugging purposes

    print(len(points_on_curve))  # Print the number of points on the curve that will have circles for 
                                  #debugging purposes

    i = -1  # Index for iterating through the points on the curve
    for pt in points_on_curve:
#        radius = 0.045 # Radius of the circle to be added
#        depth = 0.001  # Depth of the circle
        i = i + 1  # Increment the index

#        bpy.context.scene.cursor.location = pt  # Set the 3D cursor location to the current point on the curve

#    # Add a new Bezier circle with the specified radius and rotation
#        bpy.ops.curve.primitive_bezier_circle_add(radius=radius, rotation=rotation[0][i])
#        curve = bpy.context.object  # Get the reference to the newly added circle object
#        curve.name = "MyCurve"  # Set the name of the circle object

#        curve.data.resolution_u = 512  # Set the resolution of the circle curve
#        curve.select_set(True)  # Select the circle object
#        bpy.ops.object.mode_set(mode='EDIT')  # Enter edit mode

#        bpy.context.object.data.extrude = depth  # Set the extrusion depth of the circle
#        bpy.ops.object.mode_set(mode='OBJECT')  # Exit edit mode

#        mat = bpy.data.materials.new(name="Red")  # Create a new material with the name "Red"
#        mat.diffuse_color = (1.0, 0.0, 0.0, 1.0)  # Set the diffuse color of the material to red
##        mat.roughness = 0.5
#        bpy.context.object.data.materials.append(mat)  # Assign the material to the circle object

#        bpy.ops.object.convert(target='MESH')  # Convert the circle object to a mesh
#        bpy.ops.object.mode_set(mode='EDIT')  # Enter edit mode for the mesh

#        bpy.ops.mesh.select_all(action='SELECT')  # Select all vertices, edges, and faces of the mesh
#        bpy.ops.mesh.fill()  # Fill the selected region with faces

#        bpy.context.scene.cursor.location = (0, 0, 0)  # Reset the 3D cursor location to the origin
#        bpy.ops.mesh.select_all(action='DESELECT')  # Deselect all vertices, edges, and faces of the mesh
#        bpy.ops.object.mode_set(mode='OBJECT')  # Exit edit mode
        file_path = "D:\\mitacs_blender\\force\\Jal_mid.stl"

        # Import the STL file as a mesh object
        bpy.ops.import_mesh.stl(filepath=file_path)
        imported_mesh = bpy.context.object
        bpy.ops.object.origin_set(type='ORIGIN_CENTER_OF_MASS', center='BOUNDS')
    
        scale_factor = 0.0015  # Example: scale down by 50%
        imported_mesh.scale = (scale_factor, scale_factor, scale_factor)
    
    
        imported_mesh.location = pt
        imported_mesh.rotation_euler = rotation[0][i]
        imported_mesh.name = "MyCurve"
    
        mat = bpy.data.materials.new(name="Red")
        mat.diffuse_color = (1.0, 0.0, 0.0, 1.0)
        imported_mesh.data.materials.append(mat)

# Enter edit mode for the mesh
        bpy.ops.object.mode_set(mode='EDIT')

# Fill the selected region with faces
        bpy.ops.mesh.select_all(action='SELECT')
  

# Reset the 3D cursor location to the origin
        bpy.context.scene.cursor.location = (0, 0, 0)

# Deselect all vertices, edges, and faces of the mesh
        bpy.ops.mesh.select_all(action='DESELECT')

# Exit edit mode
        bpy.ops.object.mode_set(mode='OBJECT')
# 

   
    bpy.context.scene.render.image_settings.file_format = 'PNG'  # Set the file format (e.g., PNG, JPEG, etc.
    
    output_folder = "output_folder"

    # Create the output folder if it doesn't exist
    output_path = os.path.join("D:\\mitacs_blender\\force", output_folder)
    if not os.path.exists(output_path):
        os.makedirs(output_path)

# Loop through camera configurations
    for config in camera_configurations:
    # Create a new camera
        bpy.ops.object.camera_add()
        camera = bpy.context.object

    # Set camera location and rotation
        camera.location = config['location']
        camera.rotation_euler = config['rotation_euler']

    # Set camera parameters
        camera.data.type = 'PERSP'
        camera.data.lens = config['lens']

    # Set the camera as active
        bpy.context.scene.camera = camera

    # Set the output file path
        filepath = os.path.join(output_path, config['filename'])
        bpy.context.scene.render.filepath = filepath

    # Render the image
        bpy.ops.render.render(write_still=True)

        print("Image '{}' rendered and saved successfully.".format(config['filename']))



positions = [
[(0.0, 0.0, 0.0), (-6.1563e-10, -1.1297e-18, 0.010256), (-3.3225e-06, -9.8159e-16, 0.020513), (-9.8659e-06, -5.8839e-15, 0.030769), (-1.9531e-05, -1.7557e-14, 0.041026), (-3.2219e-05, -3.8756e-14, 0.051282), (-4.7829e-05, -7.2141e-14, 0.061538), (-6.6261e-05, -1.2028e-13, 0.071795), (-8.7416e-05, -1.8566e-13, 0.082051), (-0.00011119, -2.7066e-13, 0.092308), (-0.00013749, -3.7758e-13, 0.10256), (-0.00016622, -5.0863e-13, 0.11282), (-0.00019726, -6.6596e-13, 0.12308), (-0.00023052, -8.516e-13, 0.13333), (-0.0002659, -1.0675e-12, 0.14359), (-0.00030329, -1.3157e-12, 0.15385), (-0.0003426, -1.5979e-12, 0.1641), (-0.00038371, -1.9159e-12, 0.17436), (-0.00042654, -2.2715e-12, 0.18461), (-0.00047096, -2.6664e-12, 0.19487), (-0.00051689, -3.1022e-12, 0.20513), (-0.00056422, -3.5805e-12, 0.21538), (-0.00061284, -4.1029e-12, 0.22564), (-0.00066267, -4.6712e-12, 0.2359), (-0.00071359, -5.2868e-12, 0.24615), (-0.00076551, -5.9515e-12, 0.25641), (-0.00081833, -6.6669e-12, 0.26667), (-0.00087196, -7.4349e-12, 0.27692), (-0.00092631, -8.2572e-12, 0.28718), (-0.00098129, -9.1359e-12, 0.29743), (-0.0010368, -1.0073e-11, 0.30769), (-0.0010928, -1.1071e-11, 0.31795), (-0.0011492, -1.2131e-11, 0.3282), (-0.0012059, -1.3258e-11, 0.33846), (-0.0012628, -1.4452e-11, 0.34872), (-0.00132, -1.5719e-11, 0.35897), (-0.0013772, -1.706e-11, 0.36923), (-0.0014346, -1.8481e-11, 0.37948), (-0.0014921, -1.9984e-11, 0.38974), (-0.0015495, -2.1574e-11, 0.4)] 
 # Give the position arguments here to draw the backone and tendons of the arm as required.
#    [(0.0, 0.0, 0.0), (0.09659258262890684, 0.025881904510252074, 0.1), (0.19318516525781368, 0.05176380902050415, 0.2), (0.2897777478867205, 0.07764571353075622, 0.3), (0.38637033051562736, 0.1035276180410083, 0.4), (0.48296291314453416, 0.12940952255126037, 0.5), (0.579555495773441, 0.15529142706151244, 0.6), (0.6761480784023478, 0.18117333157176452, 0.7), (0.7727406610312547, 0.2070552360820166, 0.8), (0.8693332436601615, 0.23293714059226867, 0.9), (0.9659258262890683, 0.25881904510252074, 1.0), (1.0625184089179753, 0.2847009496127728, 1.1), (1.159110991546882, 0.3105828541230249, 1.2), (1.255703574175789, 0.33646475863327696, 1.3), (1.3522961568046956, 0.36234666314352904, 1.4), (1.4488887394336025, 0.3882285676537811, 1.5), (1.5454813220625094, 0.4141104721640332, 1.6), (1.6420739046914161, 0.43999237667428526, 1.7), (1.738666487320323, 0.46587428118453733, 1.8), (1.8352590699492297, 0.4917561856947894, 1.9), (1.9318516525781366, 0.5176380902050415, 2.0), (2.0284442352070435, 0.5435199947152936, 2.1), (2.1250368178359507, 0.5694018992255456, 2.2), (2.221629400464857, 0.5952838037357977, 2.3), (2.318221983093764, 0.6211657082460498, 2.4), (2.4148145657226707, 0.6470476127563018, 2.5), (2.511407148351578, 0.6729295172665539, 2.6), (2.6079997309804845, 0.698811421776806, 2.7), (2.7045923136093912, 0.7246933262870581, 2.8), (2.801184896238298, 0.7505752307973101, 2.9), (2.897777478867205, 0.7764571353075622, 3.0), (2.9943700614961117, 0.8023390398178143, 3.1), (3.090962644125019, 0.8282209443280664, 3.2), (3.187555226753925, 0.8541028488383184, 3.3), (3.2841478093828322, 0.8799847533485705, 3.4), (3.380740392011739, 0.9058666578588226, 3.5), (3.477332974640646, 0.9317485623690747, 3.6), (3.5739255572695527, 0.9576304668793267, 3.7), (3.6705181398984594, 0.9835123713895788, 3.8), (3.767110722527366, 1.0093942758998309, 3.9), (3.8637033051562732, 1.035276180410083, 4.0), (3.96029588778518, 1.061158084920335, 4.1), (4.056888470414087, 1.087039989430587, 4.2), (4.153481053042993, 1.1129218939408392, 4.3), (4.250073635671901, 1.1388037984510913, 4.4), (4.346666218300808, 1.1646857029613433, 4.5), (4.443258800929714, 1.1905676074715954, 4.6), (4.539851383558621, 1.2164495119818475, 4.7), (4.636443966187528, 1.2423314164920995, 4.8), (4.733036548816435, 1.2682133210023516, 4.9), (4.8296291314453415, 1.2940952255126037, 5.0), (4.926221714074248, 1.3199771300228558, 5.1), (5.022814296703156, 1.3458590345331078, 5.2), (5.119406879332062, 1.37174093904336, 5.3), (5.215999461960969, 1.397622843553612, 5.4), (5.312592044589875, 1.423504748063864, 5.5), (5.4091846272187825, 1.4493866525741161, 5.6), (5.50577720984769, 1.4752685570843682, 5.7), (5.602369792476596, 1.5011504615946203, 5.8), (5.698962375105503, 1.5270323661048724, 5.9), (5.79555495773441, 1.5529142706151244, 6.0), (5.892147540363316, 1.5787961751253765, 6.1), (5.9887401229922235, 1.6046780796356286, 6.2), (6.085332705621131, 1.6305599841458807, 6.3), (6.181925288250038, 1.6564418886561327, 6.4), (6.278517870878944, 1.6823237931663848, 6.5), (6.37511045350785, 1.7082056976766369, 6.6), (6.471703036136758, 1.734087602186889, 6.7), (6.5682956187656645, 1.759969506697141, 6.8), (6.664888201394572, 1.785851411207393, 6.9), (6.761480784023478, 1.8117333157176452, 7.0), (6.858073366652385, 1.8376152202278973, 7.1), (6.954665949281292, 1.8634971247381493, 7.2), (7.051258531910198, 1.8893790292484014, 7.3), (7.1478511145391055, 1.9152609337586535, 7.4), (7.244443697168013, 1.9411428382689055, 7.5), (7.341036279796919, 1.9670247427791576, 7.6), (7.437628862425826, 1.9929066472894097, 7.7), (7.534221445054732, 2.0187885517996618, 7.8), (7.63081402768364, 2.044670456309914, 7.9), (7.7274066103125465, 2.070552360820166, 8.0), (7.823999192941453, 2.096434265330418, 8.1), (7.92059177557036, 2.12231616984067, 8.2), (8.017184358199268, 2.148198074350922, 8.3), (8.113776940828174, 2.174079978861174, 8.4), (8.21036952345708, 2.1999618833714263, 8.5), (8.306962106085987, 2.2258437878816784, 8.6), (8.403554688714893, 2.2517256923919304, 8.7), (8.500147271343803, 2.2776075969021825, 8.8), (8.596739853972709, 2.3034895014124346, 8.9), (8.693332436601615, 2.3293714059226867, 9.0), (8.789925019230521, 2.3552533104329387, 9.1), (8.886517601859428, 2.381135214943191, 9.2), (8.983110184488336, 2.407017119453443, 9.3), (9.079702767117242, 2.432899023963695, 9.4), (9.176295349746148, 2.458780928473947, 9.5), (9.272887932375056, 2.484662832984199, 9.6), (9.369480515003962, 2.510544737494451, 9.7), (9.46607309763287, 2.5364266420047032, 9.8), (9.562665680261777, 2.5623085465149553, 9.9)]
#[(0.0, 0.0, 0.0), (0.001, 0.01, 0.1), (0.002, 0.02062821518156257, 0.2), (0.003, 0.03188402557214884, 0.30000000000000004), (0.004, 0.043766191838519125, 0.4), (0.005, 0.05627285650980521, 0.5), (0.006, 0.06940154581060982, 0.6), (0.007, 0.08314917210232431, 0.7), (0.008, 0.09751203693025516, 0.7999999999999999), (0.009000000000000001, 0.11248583467355226, 0.8999999999999999), (0.010000000000000002, 0.12806565679433685, 0.9999999999999999), (0.011000000000000003, 0.1442459966818358, 1.0999999999999999), (0.012000000000000004, 0.16102075508674163, 1.2), (0.013000000000000005, 0.1783832461404352, 1.3), (0.014000000000000005, 0.1963262039531308, 1.4000000000000001), (0.015000000000000006, 0.21484178978443225, 1.5000000000000002), (0.016000000000000007, 0.23392159977922317, 1.6000000000000003), (0.017000000000000008, 0.25355667326125747, 1.7000000000000004), (0.01800000000000001, 0.2737375015762649, 1.8000000000000005), (0.01900000000000001, 0.29445403747584487, 1.9000000000000006), (0.02000000000000001, 0.31569570503288746, 2.0000000000000004), (0.02100000000000001, 0.3374514100787369, 2.1000000000000005), (0.022000000000000013, 0.3597095511517964, 2.2000000000000006), (0.023000000000000013, 0.3824580309467702, 2.3000000000000007), (0.024000000000000014, 0.4056842682532433, 2.400000000000001), (0.025000000000000015, 0.42937521037181703, 2.500000000000001), (0.026000000000000016, 0.453517345995548, 2.600000000000001), (0.027000000000000017, 0.47809671854397623, 2.700000000000001), (0.028000000000000018, 0.5030989399365854, 2.800000000000001), (0.02900000000000002, 0.5285092047921012, 2.9000000000000012), (0.03000000000000002, 0.5543123050396149, 3.0000000000000013), (0.03100000000000002, 0.5804926449271138, 3.1000000000000014), (0.03200000000000002, 0.6070342564126051, 3.2000000000000015), (0.03300000000000002, 0.6339208149226454, 3.3000000000000016), (0.03400000000000002, 0.6611356554627242, 3.4000000000000017), (0.035000000000000024, 0.6886617890636015, 3.5000000000000018), (0.036000000000000025, 0.7164819195473688, 3.600000000000002), (0.037000000000000026, 0.7445784605966892, 3.700000000000002), (0.03800000000000003, 0.7729335531103688, 3.800000000000002), (0.03900000000000003, 0.8015290828281338, 3.900000000000002), (0.04000000000000003, 0.8303466982072184, 4.000000000000002), (0.04100000000000003, 0.8593678285331214, 4.100000000000001), (0.04200000000000003, 0.8885737022466603, 4.200000000000001), (0.04300000000000003, 0.9179453654692329, 4.300000000000001), (0.04400000000000003, 0.9474637007080078, 4.4), (0.04500000000000003, 0.9771094457225815, 4.5), (0.046000000000000034, 1.0068632125344843, 4.6), (0.047000000000000035, 1.0367055065607738, 4.699999999999999), (0.048000000000000036, 1.0666167458528353, 4.799999999999999), (0.04900000000000004, 1.0965772804214007, 4.899999999999999), (0.05000000000000004, 1.1265674116287152, 4.999999999999998), (0.05100000000000004, 1.1565674116287152, 5.099999999999998), (0.05200000000000004, 1.1865575428360298, 5.1999999999999975), (0.05300000000000004, 1.2165180774045952, 5.299999999999997), (0.05400000000000004, 1.2464293166966567, 5.399999999999997), (0.05500000000000004, 1.2762716107229461, 5.4999999999999964), (0.05600000000000004, 1.306025377534849, 5.599999999999996), (0.057000000000000044, 1.3356711225494227, 5.699999999999996), (0.058000000000000045, 1.3651894577881976, 5.799999999999995), (0.059000000000000045, 1.3945611210107702, 5.899999999999995), (0.060000000000000046, 1.423766994724309, 5.999999999999995), (0.06100000000000005, 1.4527881250502122, 6.099999999999994), (0.06200000000000005, 1.4816057404292966, 6.199999999999994), (0.06300000000000004, 1.5102012701470617, 6.299999999999994), (0.06400000000000004, 1.5385563626607413, 6.399999999999993), (0.06500000000000004, 1.5666529037100616, 6.499999999999993), (0.06600000000000004, 1.594473034193829, 6.5999999999999925), (0.06700000000000005, 1.621999167794706, 6.699999999999992), (0.06800000000000005, 1.649214008334785, 6.799999999999992), (0.06900000000000005, 1.6761005668448254, 6.8999999999999915), (0.07000000000000005, 1.7026421783303167, 6.999999999999991), (0.07100000000000005, 1.7288225182178156, 7.099999999999991), (0.07200000000000005, 1.7546256184653295, 7.19999999999999), (0.07300000000000005, 1.7800358833208452, 7.29999999999999), (0.07400000000000005, 1.8050381047134543, 7.39999999999999), (0.07500000000000005, 1.8296174772618825, 7.499999999999989), (0.07600000000000005, 1.8537596128856135, 7.599999999999989), (0.07700000000000005, 1.8774505550041873, 7.699999999999989), (0.07800000000000006, 1.9006767923106604, 7.799999999999988), (0.07900000000000006, 1.9234252721056342, 7.899999999999988), (0.08000000000000006, 1.9456834131786938, 7.999999999999988), (0.08100000000000006, 1.9674391182245432, 8.099999999999987), (0.08200000000000006, 1.9886807857815858, 8.199999999999987), (0.08300000000000006, 2.0093973216811656, 8.299999999999986), (0.08400000000000006, 2.029578149996173, 8.399999999999986), (0.08500000000000006, 2.0492132234782074, 8.499999999999986), (0.08600000000000006, 2.0682930334729983, 8.599999999999985), (0.08700000000000006, 2.0868086193043, 8.699999999999985), (0.08800000000000006, 2.1047515771169953, 8.799999999999985), (0.08900000000000007, 2.122114068170689, 8.899999999999984), (0.09000000000000007, 2.1388888265755948, 8.999999999999984), (0.09100000000000007, 2.1550691664630937, 9.099999999999984), (0.09200000000000007, 2.1706489885838782, 9.199999999999983), (0.09300000000000007, 2.1856227863271753, 9.299999999999983), (0.09400000000000007, 2.199985651155106, 9.399999999999983), (0.09500000000000007, 2.2137332774468206, 9.499999999999982), (0.09600000000000007, 2.226861966747625, 9.599999999999982), (0.09700000000000007, 2.239368631418911, 9.699999999999982), (0.09800000000000007, 2.2512507976852816, 9.799999999999981), (0.09900000000000007, 2.262506608075868, 9.89999999999998)]
#[(0.0, 0.0, 0.0), (0.0001, 0.001, 0.01), (0.0002, 0.002062821518156257, 0.02), (0.00030000000000000003, 0.003188402557214884, 0.030000000000000006), (0.0004, 0.004376619183851913, 0.04), (0.0005, 0.0056272856509805205, 0.05), (0.0006000000000000001, 0.006940154581060983, 0.06), (0.0007, 0.00831491721023243, 0.06999999999999999), (0.0008, 0.009751203693025515, 0.07999999999999999), (0.0009000000000000001, 0.011248583467355227, 0.09), (0.0010000000000000002, 0.012806565679433685, 0.09999999999999999), (0.0011000000000000003, 0.01442459966818358, 0.10999999999999999), (0.0012000000000000003, 0.016102075508674162, 0.12), (0.0013000000000000004, 0.01783832461404352, 0.13), (0.0014000000000000006, 0.01963262039531308, 0.14), (0.0015000000000000007, 0.021484178978443225, 0.15000000000000002), (0.0016000000000000007, 0.023392159977922315, 0.16000000000000003), (0.0017000000000000008, 0.025355667326125746, 0.17000000000000004), (0.0018000000000000008, 0.02737375015762649, 0.18000000000000005), (0.001900000000000001, 0.029445403747584486, 0.19000000000000006), (0.002000000000000001, 0.03156957050328875, 0.20000000000000004), (0.002100000000000001, 0.033745141007873694, 0.21000000000000005), (0.0022000000000000014, 0.03597095511517964, 0.22000000000000006), (0.0023000000000000013, 0.038245803094677025, 0.23000000000000007), (0.0024000000000000015, 0.04056842682532433, 0.24000000000000007), (0.0025000000000000014, 0.0429375210371817, 0.2500000000000001), (0.0026000000000000016, 0.0453517345995548, 0.2600000000000001), (0.002700000000000002, 0.04780967185439762, 0.27000000000000013), (0.0028000000000000017, 0.05030989399365854, 0.28000000000000014), (0.002900000000000002, 0.05285092047921012, 0.29000000000000015), (0.003000000000000002, 0.055431230503961496, 0.30000000000000016), (0.003100000000000002, 0.05804926449271138, 0.31000000000000016), (0.0032000000000000023, 0.06070342564126051, 0.3200000000000002), (0.003300000000000002, 0.06339208149226454, 0.3300000000000002), (0.0034000000000000024, 0.06611356554627243, 0.3400000000000002), (0.0035000000000000022, 0.06886617890636015, 0.3500000000000002), (0.0036000000000000025, 0.07164819195473689, 0.3600000000000002), (0.0037000000000000028, 0.07445784605966892, 0.3700000000000002), (0.0038000000000000026, 0.07729335531103688, 0.3800000000000002), (0.003900000000000003, 0.08015290828281338, 0.39000000000000024), (0.004000000000000003, 0.08303466982072184, 0.4000000000000002), (0.004100000000000003, 0.08593678285331215, 0.41000000000000014), (0.004200000000000003, 0.08885737022466603, 0.4200000000000001), (0.0043000000000000035, 0.0917945365469233, 0.43000000000000005), (0.004400000000000003, 0.09474637007080078, 0.44000000000000006), (0.004500000000000003, 0.09771094457225815, 0.45), (0.004600000000000003, 0.10068632125344842, 0.45999999999999996), (0.004700000000000004, 0.10367055065607737, 0.4699999999999999), (0.004800000000000004, 0.10666167458528353, 0.47999999999999987), (0.004900000000000003, 0.10965772804214007, 0.4899999999999999), (0.005000000000000004, 0.11265674116287153, 0.49999999999999983), (0.005100000000000004, 0.11565674116287153, 0.5099999999999998), (0.005200000000000004, 0.11865575428360298, 0.5199999999999998), (0.005300000000000004, 0.12165180774045951, 0.5299999999999997), (0.005400000000000004, 0.12464293166966567, 0.5399999999999997), (0.005500000000000004, 0.1276271610722946, 0.5499999999999996), (0.005600000000000004, 0.1306025377534849, 0.5599999999999996), (0.0057000000000000045, 0.13356711225494228, 0.5699999999999996), (0.005800000000000005, 0.13651894577881976, 0.5799999999999995), (0.005900000000000004, 0.13945611210107703, 0.5899999999999995), (0.0060000000000000045, 0.1423766994724309, 0.5999999999999994), (0.006100000000000005, 0.14527881250502123, 0.6099999999999994), (0.006200000000000005, 0.14816057404292965, 0.6199999999999994), (0.006300000000000004, 0.15102012701470618, 0.6299999999999993), (0.006400000000000005, 0.15385563626607413, 0.6399999999999993), (0.006500000000000004, 0.15666529037100616, 0.6499999999999992), (0.006600000000000004, 0.1594473034193829, 0.6599999999999993), (0.0067000000000000046, 0.1621999167794706, 0.6699999999999993), (0.006800000000000005, 0.1649214008334785, 0.6799999999999992), (0.006900000000000005, 0.16761005668448253, 0.6899999999999992), (0.0070000000000000045, 0.17026421783303167, 0.6999999999999991), (0.007100000000000005, 0.17288225182178157, 0.7099999999999991), (0.007200000000000005, 0.17546256184653294, 0.7199999999999991), (0.007300000000000005, 0.17800358833208452, 0.729999999999999), (0.0074000000000000055, 0.18050381047134542, 0.739999999999999), (0.007500000000000005, 0.18296174772618826, 0.7499999999999989), (0.007600000000000005, 0.18537596128856135, 0.7599999999999989), (0.0077000000000000055, 0.18774505550041873, 0.7699999999999989), (0.007800000000000006, 0.19006767923106604, 0.7799999999999988), (0.007900000000000006, 0.1923425272105634, 0.7899999999999988), (0.008000000000000005, 0.19456834131786938, 0.7999999999999987), (0.008100000000000007, 0.19674391182245432, 0.8099999999999987), (0.008200000000000006, 0.19886807857815858, 0.8199999999999987), (0.008300000000000005, 0.20093973216811656, 0.8299999999999986), (0.008400000000000006, 0.20295781499961732, 0.8399999999999986), (0.008500000000000006, 0.20492132234782073, 0.8499999999999985), (0.008600000000000007, 0.20682930334729982, 0.8599999999999985), (0.008700000000000006, 0.20868086193042998, 0.8699999999999986), (0.008800000000000006, 0.21047515771169953, 0.8799999999999985), (0.008900000000000007, 0.2122114068170689, 0.8899999999999985), (0.009000000000000006, 0.21388888265755948, 0.8999999999999984), (0.009100000000000007, 0.21550691664630936, 0.9099999999999984), (0.009200000000000007, 0.2170648988583878, 0.9199999999999984), (0.009300000000000006, 0.21856227863271754, 0.9299999999999983), (0.009400000000000007, 0.2199985651155106, 0.9399999999999983), (0.009500000000000007, 0.22137332774468205, 0.9499999999999982), (0.009600000000000008, 0.2226861966747625, 0.9599999999999982), (0.009700000000000007, 0.22393686314189112, 0.9699999999999982), (0.009800000000000007, 0.22512507976852816, 0.9799999999999981), (0.009900000000000008, 0.2262506608075868, 0.9899999999999981)]
]
# Give the rotation arguments here to draw the disks on the backbone as required.
rotation = [
[(0.0, 0.0, 0.0), (9.5484e-14, -0.00032382, 1.2222e-09), (4.7787e-13, -0.00063792, 2.4444e-09), (1.138e-12, -0.0009423, 3.6666e-09), (2.0668e-12, -0.001237, 4.8888e-09), (3.255e-12, -0.0015219, 6.111e-09), (4.6938e-12, -0.0017971, 7.3331e-09), (6.3741e-12, -0.0020626, 8.5553e-09), (8.2872e-12, -0.0023183, 9.7775e-09), (1.0425e-11, -0.0025642, 1.1e-08), (1.2778e-11, -0.0028003, 1.2222e-08), (1.5339e-11, -0.0030265, 1.3444e-08), (1.81e-11, -0.0032429, 1.4666e-08), (2.1055e-11, -0.0034493, 1.5889e-08), (2.4195e-11, -0.0036458, 1.7111e-08), (2.7515e-11, -0.0038323, 1.8333e-08), (3.1009e-11, -0.0040087, 1.9555e-08), (3.4672e-11, -0.0041752, 2.0777e-08), (3.8499e-11, -0.0043316, 2.2e-08), (4.2488e-11, -0.004478, 2.3222e-08), (4.6636e-11, -0.0046144, 2.4444e-08), (5.0941e-11, -0.0047409, 2.5666e-08), (5.5404e-11, -0.0048576, 2.6888e-08), (6.0025e-11, -0.0049646, 2.8111e-08), (6.4809e-11, -0.0050621, 2.9333e-08), (6.9758e-11, -0.0051501, 3.0555e-08), (7.4879e-11, -0.005229, 3.1777e-08), (8.018e-11, -0.005299, 3.2999e-08), (8.5671e-11, -0.0053604, 3.4222e-08), (9.1365e-11, -0.0054136, 3.5444e-08), (9.7275e-11, -0.0054589, 3.6666e-08), (1.0342e-10, -0.0054968, 3.7888e-08), (1.0982e-10, -0.0055278, 3.9111e-08), (1.165e-10, -0.0055524, 4.0333e-08), (1.2348e-10, -0.0055713, 4.1555e-08), (1.308e-10, -0.005585, 4.2777e-08), (1.3848e-10, -0.0055944, 4.3999e-08), (1.4656e-10, -0.0056001, 4.5222e-08), (1.5509e-10, -0.0056031, 4.6444e-08), (1.6411e-10, -0.005604, 4.7666e-08)]
#    [(4.6734e-10,-0.01744,4.7668e-08), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0),(0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0)],
]

#Run the code
for pos in positions:
    draw_polyline(pos,rotation)
