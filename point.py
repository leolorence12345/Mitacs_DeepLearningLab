# import cv2
# import numpy as np
# import matplotlib.pyplot as plt

# # Create a blank image
# image = np.zeros((1000, 1000, 3), dtype=np.uint8)

# # Scale and shift the points to fit within the image size

# points = np.array([[    0.32031,     0.20192],
#        [    0.31875,     0.20565],
#        [    0.31875,     0.34724],
#        [    0.32031,     0.35096],
#        [    0.32031,     0.35469],
#        [    0.32344,     0.36214],
#        [      0.325,     0.36214],
#        [    0.32656,     0.36587],
#        [    0.32812,     0.36587],
#        [    0.32969,     0.36959],
#        [    0.33125,     0.36959],
#        [    0.33281,     0.37332],
#        [    0.33438,     0.37332],
#        [    0.33594,     0.37704],
#        [     0.3375,     0.37704],
#        [    0.33906,     0.38077],
#        [    0.34219,     0.38077],
#        [    0.34375,      0.3845],
#        [    0.34531,      0.3845],
#        [    0.34688,     0.38822],
#        [    0.34844,     0.38822],
#        [       0.35,     0.39195],
#        [    0.35313,     0.39195],
#        [    0.35469,     0.39567],
#        [    0.35625,     0.39567],
#        [    0.35938,     0.40313],
#        [    0.36094,     0.40313],
#        [     0.3625,     0.40685],
#        [    0.36563,     0.40685],
#        [    0.36719,     0.41058],
#        [    0.36875,     0.41058],
#        [    0.37188,     0.41803],
#        [    0.37344,     0.41803],
#        [      0.375,     0.42175],
#        [    0.37813,     0.42175],
#        [    0.38125,     0.42921],
#        [    0.38281,     0.42921],
#        [    0.38438,     0.43293],
#        [    0.38594,     0.43293],
#        [     0.3875,     0.43666],
#        [    0.38906,     0.43666],
#        [    0.39062,     0.44038],
#        [    0.39219,     0.44038],
#        [    0.39375,     0.44411],
#        [    0.39531,     0.44411],
#        [    0.39688,     0.44784],
#        [    0.39844,     0.44784],
#        [        0.4,     0.45156],
#        [    0.40313,     0.45156],
#        [    0.40625,     0.45901],
#        [    0.40781,     0.45901],
#        [    0.40938,     0.46274],
#        [    0.41094,     0.46274],
#        [     0.4125,     0.46647],
#        [    0.41563,     0.46647],
#        [    0.41719,     0.47019],
#        [    0.41875,     0.47019],
#        [    0.42031,     0.47392],
#        [    0.42188,     0.47392],
#        [    0.42344,     0.47764],
#        [      0.425,     0.47764],
#        [    0.42656,     0.48137],
#        [    0.42969,     0.48137],
#        [    0.43281,     0.48882],
#        [    0.43438,     0.48882],
#        [    0.43594,     0.49255],
#        [     0.4375,     0.49255],
#        [    0.43906,     0.49627],
#        [    0.44063,     0.49627],
#        [    0.44375,     0.50373],
#        [    0.44531,     0.50373],
#        [    0.44688,     0.50745],
#        [    0.44844,     0.50745],
#        [       0.45,     0.51118],
#        [    0.45156,     0.51118],
#        [    0.45312,      0.5149],
#        [    0.45469,      0.5149],
#        [    0.45625,     0.51863],
#        [    0.45781,     0.51863],
#        [    0.45938,     0.52236],
#        [    0.46094,     0.52236],
#        [     0.4625,     0.52608],
#        [    0.46406,     0.52608],
#        [    0.46563,     0.52981],
#        [    0.46719,     0.52981],
#        [    0.47031,     0.53726],
#        [    0.47344,     0.53726],
#        [      0.475,     0.54099],
#        [    0.47813,     0.54099],
#        [    0.48125,     0.54844],
#        [    0.48281,     0.54844],
#        [    0.48438,     0.55216],
#        [    0.48594,     0.55216],
#        [     0.4875,     0.55589],
#        [    0.48906,     0.55589],
#        [    0.49063,     0.55962],
#        [    0.49219,     0.55962],
#        [    0.49375,     0.56334],
#        [    0.49531,     0.56334],
#        [    0.49688,     0.56707],
#        [    0.50156,     0.56707],
#        [    0.50313,     0.57079],
#        [    0.50469,     0.57079],
#        [    0.50625,     0.57452],
#        [    0.50781,     0.57452],
#        [    0.50938,     0.57825],
#        [    0.51094,     0.57825],
#        [     0.5125,     0.58197],
#        [    0.51562,     0.58197],
#        [    0.51719,      0.5857],
#        [    0.51875,      0.5857],
#        [    0.52031,     0.58942],
#        [    0.52344,     0.58942],
#        [      0.525,     0.59315],
#        [    0.52656,     0.59315],
#        [    0.52813,     0.59688],
#        [    0.52969,     0.59688],
#        [    0.53125,      0.6006],
#        [    0.53281,      0.6006],
#        [    0.53438,     0.60433],
#        [    0.53594,     0.60433],
#        [     0.5375,     0.60805],
#        [    0.53906,     0.60805],
#        [    0.54062,     0.61178],
#        [    0.54219,     0.61178],
#        [    0.54375,      0.6155],
#        [    0.54531,      0.6155],
#        [    0.54688,     0.61923],
#        [    0.54844,     0.61923],
#        [       0.55,     0.62296],
#        [    0.55156,     0.62296],
#        [    0.55313,     0.62668],
#        [    0.55625,     0.62668],
#        [    0.55781,     0.63041],
#        [     0.5625,     0.63041],
#        [    0.56406,     0.63413],
#        [    0.56719,     0.63413],
#        [    0.56875,     0.63786],
#        [    0.57031,     0.63786],
#        [    0.57187,     0.64159],
#        [      0.575,     0.64159],
#        [    0.57656,     0.64531],
#        [    0.57969,     0.64531],
#        [    0.58125,     0.64904],
#        [    0.58281,     0.64904],
#        [    0.58438,     0.65276],
#        [    0.58594,     0.65276],
#        [     0.5875,     0.65649],
#        [    0.58906,     0.65649],
#        [    0.59063,     0.66022],
#        [    0.59219,     0.66022],
#        [    0.59375,     0.66394],
#        [    0.59531,     0.66394],
#        [    0.59688,     0.66767],
#        [    0.59844,     0.66767],
#        [        0.6,     0.67139],
#        [    0.60156,     0.67139],
#        [    0.60312,     0.67512],
#        [    0.60469,     0.67512],
#        [    0.60938,      0.6863],
#        [    0.61094,      0.6863],
#        [     0.6125,     0.69002],
#        [    0.61406,     0.69002],
#        [    0.61563,     0.69375],
#        [    0.61719,     0.69375],
#        [    0.62188,     0.70493],
#        [    0.62344,     0.70493],
#        [      0.625,     0.70865],
#        [    0.62656,     0.70865],
#        [    0.62969,     0.71611],
#        [    0.63125,     0.71611],
#        [    0.63281,     0.71983],
#        [    0.63438,     0.71983],
#        [    0.63594,     0.72356],
#        [     0.6375,     0.72356],
#        [    0.63906,     0.72728],
#        [    0.64062,     0.72728],
#        [    0.64219,     0.73101],
#        [    0.64531,     0.73101],
#        [    0.64688,     0.73474],
#        [       0.65,     0.73474],
#        [    0.65156,     0.73846],
#        [    0.65313,     0.73846],
#        [    0.65781,     0.74964],
#        [    0.65938,     0.74964],
#        [    0.66406,     0.76082],
#        [    0.66563,     0.76082],
#        [    0.66719,     0.76454],
#        [    0.66875,     0.76454],
#        [    0.67188,       0.772],
#        [    0.67344,       0.772],
#        [      0.675,     0.77572],
#        [    0.67656,     0.77572],
#        [    0.67813,     0.77945],
#        [    0.68125,     0.77945],
#        [    0.68281,     0.78317],
#        [    0.68594,     0.78317],
#        [     0.6875,      0.7869],
#        [        0.7,      0.7869],
#        [    0.70156,     0.78317],
#        [    0.70469,     0.78317],
#        [    0.70625,     0.77945],
#        [    0.70781,     0.77945],
#        [    0.70938,     0.77572],
#        [    0.71094,     0.77572],
#        [     0.7125,       0.772],
#        [    0.71406,       0.772],
#        [    0.71719,     0.76454],
#        [    0.71875,     0.76454],
#        [    0.72031,     0.76082],
#        [    0.72188,     0.76082],
#        [    0.72813,     0.74591],
#        [    0.72969,     0.74591],
#        [    0.72969,     0.74219],
#        [    0.73281,     0.73474],
#        [    0.73281,     0.72728],
#        [    0.73438,     0.72356],
#        [    0.73438,     0.66022],
#        [    0.73281,     0.65649],
#        [    0.73281,     0.64904],
#        [    0.73125,     0.64531],
#        [    0.72969,     0.64531],
#        [      0.725,     0.63413],
#        [    0.72344,     0.63413],
#        [    0.72188,     0.63041],
#        [    0.72031,     0.63041],
#        [    0.71719,     0.62296],
#        [    0.71563,     0.62296],
#        [    0.71406,     0.61923],
#        [     0.7125,     0.61923],
#        [    0.71094,      0.6155],
#        [    0.70938,      0.6155],
#        [    0.70781,     0.61178],
#        [    0.70625,     0.61178],
#        [    0.70469,     0.60805],
#        [    0.70156,     0.60805],
#        [        0.7,     0.60433],
#        [    0.69688,     0.60433],
#        [    0.69531,      0.6006],
#        [    0.69063,      0.6006],
#        [    0.68906,     0.59688],
#        [     0.6875,     0.59688],
#        [    0.68594,     0.59315],
#        [    0.68281,     0.59315],
#        [    0.68125,     0.58942],
#        [    0.67656,     0.58942],
#        [      0.675,      0.5857],
#        [    0.67188,      0.5857],
#        [    0.66875,     0.57825],
#        [    0.66719,     0.57825],
#        [    0.66563,     0.57452],
#        [     0.6625,     0.57452],
#        [    0.66094,     0.57079],
#        [    0.65938,     0.57079],
#        [    0.65625,     0.56334],
#        [    0.65469,     0.56334],
#        [    0.65313,     0.55962],
#        [    0.65156,     0.55962],
#        [    0.64688,     0.54844],
#        [    0.64531,     0.54844],
#        [    0.64219,     0.54099],
#        [    0.64062,     0.54099],
#        [     0.6375,     0.53353],
#        [    0.63594,     0.53353],
#        [    0.63438,     0.52981],
#        [    0.63281,     0.52981],
#        [    0.63125,     0.52608],
#        [    0.62969,     0.52608],
#        [    0.62656,     0.51863],
#        [    0.62344,     0.51863],
#        [    0.62188,      0.5149],
#        [    0.61875,      0.5149],
#        [    0.61719,     0.51118],
#        [    0.61406,     0.51118],
#        [     0.6125,     0.50745],
#        [    0.61094,     0.50745],
#        [    0.60938,     0.50373],
#        [    0.60781,     0.50373],
#        [    0.60625,         0.5],
#        [    0.60156,         0.5],
#        [        0.6,     0.49627],
#        [    0.59844,     0.49627],
#        [    0.59531,     0.48882],
#        [    0.59375,     0.48882],
#        [    0.59219,      0.4851],
#        [    0.59063,      0.4851],
#        [    0.58125,     0.46274],
#        [    0.58125,     0.45529],
#        [    0.57969,     0.45156],
#        [    0.57969,     0.44411],
#        [    0.58125,     0.44038],
#        [    0.58125,     0.43293],
#        [    0.58281,     0.42921],
#        [    0.58281,     0.42548],
#        [    0.58594,     0.41803],
#        [    0.58594,      0.4143],
#        [    0.59063,     0.40313],
#        [    0.59063,      0.3994],
#        [    0.59375,     0.39195],
#        [    0.59375,     0.38822],
#        [    0.59531,      0.3845],
#        [    0.59531,     0.38077],
#        [    0.59688,     0.37704],
#        [    0.59688,     0.36587],
#        [    0.59844,     0.36214],
#        [    0.59844,     0.35469],
#        [    0.59688,     0.35096],
#        [    0.59688,     0.34351],
#        [    0.59531,     0.33978],
#        [    0.59531,     0.33606],
#        [    0.59375,     0.33233],
#        [    0.59375,     0.32861],
#        [    0.58281,     0.30252],
#        [    0.58125,     0.30252],
#        [    0.57812,     0.29507],
#        [    0.57656,     0.29507],
#        [    0.57344,     0.28762],
#        [    0.57187,     0.28762],
#        [    0.57031,     0.28389],
#        [    0.56875,     0.28389],
#        [    0.56719,     0.28017],
#        [    0.56563,     0.28017],
#        [    0.56406,     0.27644],
#        [     0.5625,     0.27644],
#        [    0.56094,     0.27272],
#        [    0.55938,     0.27272],
#        [    0.55781,     0.26899],
#        [    0.55625,     0.26899],
#        [    0.55469,     0.26526],
#        [    0.55313,     0.26526],
#        [    0.55156,     0.26154],
#        [       0.55,     0.26154],
#        [    0.54844,     0.25781],
#        [    0.53125,     0.25781],
#        [    0.52969,     0.26154],
#        [    0.52813,     0.26154],
#        [    0.52656,     0.26526],
#        [      0.525,     0.26526],
#        [    0.51875,     0.28017],
#        [    0.51875,     0.28389],
#        [    0.51406,     0.29507],
#        [    0.51406,     0.30252],
#        [     0.5125,     0.30625],
#        [     0.5125,      0.3137],
#        [    0.51094,     0.31743],
#        [    0.51094,     0.32115],
#        [    0.50938,     0.32488],
#        [    0.50938,     0.32861],
#        [    0.50781,     0.33233],
#        [    0.50781,     0.33606],
#        [    0.50625,     0.33978],
#        [    0.50625,     0.34351],
#        [    0.50469,     0.34724],
#        [    0.50313,     0.34724],
#        [    0.50156,     0.35096],
#        [        0.5,     0.35096],
#        [    0.49844,     0.35469],
#        [    0.49219,     0.35469],
#        [    0.49063,     0.35841],
#        [    0.48906,     0.35469],
#        [    0.48438,     0.35469],
#        [    0.48281,     0.35096],
#        [    0.48125,     0.35096],
#        [    0.47969,     0.34724],
#        [    0.47813,     0.34724],
#        [    0.47656,     0.34351],
#        [      0.475,     0.34351],
#        [    0.47031,     0.33233],
#        [    0.46875,     0.33233],
#        [    0.46563,     0.32488],
#        [    0.46406,     0.32488],
#        [     0.4625,     0.32115],
#        [    0.46094,     0.32115],
#        [    0.45781,      0.3137],
#        [    0.45625,      0.3137],
#        [    0.45156,     0.30252],
#        [       0.45,     0.30252],
#        [    0.44688,     0.29507],
#        [    0.44531,     0.29507],
#        [    0.44375,     0.29135],
#        [    0.44219,     0.29135],
#        [    0.43906,     0.28389],
#        [     0.4375,     0.28389],
#        [    0.43594,     0.28017],
#        [    0.43438,     0.28017],
#        [    0.43281,     0.27644],
#        [    0.43125,     0.27644],
#        [    0.42969,     0.27272],
#        [    0.42813,     0.27272],
#        [    0.42656,     0.26899],
#        [    0.42344,     0.26899],
#        [    0.42188,     0.26526],
#        [    0.42031,     0.26526],
#        [    0.41875,     0.26154],
#        [    0.41563,     0.26154],
#        [    0.41406,     0.25781],
#        [     0.4125,     0.25781],
#        [    0.40938,     0.25036],
#        [    0.40781,     0.25036],
#        [    0.40625,     0.24663],
#        [    0.40469,     0.24663],
#        [    0.40313,     0.24291],
#        [    0.40156,     0.24291],
#        [        0.4,     0.23918],
#        [    0.39844,     0.23918],
#        [    0.39688,     0.23546],
#        [    0.39531,     0.23546],
#        [    0.39375,     0.23173],
#        [    0.39219,     0.23173],
#        [    0.39062,       0.228],
#        [    0.38906,       0.228],
#        [     0.3875,     0.22428],
#        [    0.38594,     0.22428],
#        [    0.38281,     0.21683],
#        [    0.38125,     0.21683],
#        [    0.37813,     0.20938],
#        [    0.37344,     0.20938],
#        [    0.37188,     0.20565],
#        [    0.35625,     0.20565],
#        [    0.35469,     0.20192]], dtype=float)
# # points[:, 0] = (points[:, 0] - np.min(points[:, 0])) / (np.max(points[:, 0]) - np.min(points[:, 0])) * (image.shape[1] - 1)*(0.1)
# # points[:, 1] = (points[:, 1] - np.min(points[:, 1])) / (np.max(points[:, 1]) - np.min(points[:, 1])) * (image.shape[0] - 1)*(0.1)
# scale_factor = min(image.shape[0], image.shape[1]) * 0.8
# points[:, 0] = points[:, 0] * scale_factor
# points[:, 1] = points[:, 1] * scale_factor

# # Shift the points to the center of the image
# shift_x = (image.shape[1] - points[:, 0].max() - points[:, 0].min()) / 2
# shift_y = (image.shape[0] - points[:, 1].max() - points[:, 1].min()) / 2
# points[:, 0] = points[:, 0] + shift_x
# points[:, 1] = points[:, 1] + shift_y


# bottom_left_index = np.argmin(points.sum(axis=1))  # Index of the point with minimum sum of x and y coordinates
# top_right_index = np.argmax(points.sum(axis=1)) 
# bottom_left= points[bottom_left_index]
# top_right = points[top_right_index]
# print(bottom_left[0],top_right)
# # Draw circles at each point
# i=0
# for point in points:
#     i=i+1
#     cv2.circle(image, (int(point[0]), int(point[1])), 3, (0, 255, 0), -1)
#     # if(i==327):
#     #     break
# indices = [0,1,197]


# # Draw circles at the specified points
# for i in indices:
#     point = points[i]
#     cv2.circle(image, (int(point[0]), int(point[1])), 3, (255,0 , 0), -1)
# color = (255, 0, 0)  # Blue color (in BGR)
# thickness = 2
# # cv2.rectangle(image, (int(bottom_left[0]), int(bottom_left[1])),(int(top_right[0]), int(top_right[1])) , color, thickness)
# max_x_index = None
# max_x = float('-inf')  # Negative infinity to ensure any x-coordinate will be greater

# for index, point in enumerate(points):
#     x, y = point
#     if x > max_x:
#         max_x = x
#         max_x_index = index


# print("Index of the coordinate with maximum x-coordinate:", max_x_index)

# min_y_index = None
# min_y = float('inf')  # Positive infinity to ensure any y-coordinate will be smaller

# for index, point in enumerate(points):
#     x, y = point
#     if y < min_y:
#         min_y = y
#         min_y_index = index

# print("Index of the coordinate with minimum y-coordinate:", min_y_index)

# min_x_index = None
# min_x = float('inf')  # Positive infinity to ensure any x-coordinate will be larger

# for index, point in enumerate(points):
#     x, y = point
#     if x < min_x:
#         min_x = x
#         min_x_index = index

# print("Index of the coordinate with minimum x-coordinate:", min_x_index)

# max_y_index = None
# max_y = float('-inf')  # Negative infinity to ensure any y-coordinate will be smaller

# for index, point in enumerate(points):
#     x, y = point
#     if y > max_y:
#         max_y = y
#         max_y_index = index

# print("Index of the coordinate with maximum y-coordinate:", max_y_index)

# cv2.line(image, (int(points[0][0]),int(points[0][1])), (int(points[1][0]),int(points[1][1])), color, thickness)
# cv2.line(image, (int(points[1][0]),int(points[1][1])), (int(points[197][0]),int(points[197][1])), color, thickness)
# cv2.line(image, (int(points[216][0]),int(points[216][1])), (int(points[0][0]),int(points[0][1])), color, thickness)
# cv2.line(image, (int(points[197][0]),int(points[197][1])), (int(points[216][0]),int(points[216][1])), color, thickness)

# # Display the image
# cv2.imshow('Points', image)
# cv2.waitKey(0)
# cv2.destroyAllWindows()




import cv2
from ultralytics import YOLO

# Initialize the YOLO model
model = YOLO("D:\\mitacs_blender\\segment.pt")

# Load and process the image
img_path = 'D:\\mitacs_blender\\runs\\detect\\predict2\\crops\\Disk_1\\output_video128.jpg'
# img = model.preprocess(img_path)
img = cv2.imread(img_path)
# Perform inference on the image
results = model.predict(img)

# Get the masks for the detected objects
masks = results.pred[0]['masks'].numpy()

# Overlay each mask on the original image
for mask in masks:
    mask = (mask * 255).astype('uint8')  # Scale the mask values to 0-255
    overlay = cv2.addWeighted(img, 0.7, cv2.cvtColor(mask, cv2.COLOR_GRAY2BGR), 0.3, 0)  # Overlay mask on the image

    # Display the image with the mask
    cv2.imshow('Image with Mask', overlay)
    cv2.waitKey(0)

cv2.destroyAllWindows()




